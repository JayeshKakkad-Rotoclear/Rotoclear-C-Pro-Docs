<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>License Config - RotoClear Camera Server Documentation</title>
    <link rel="stylesheet" href="/assets/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><a href="/index.html">RotoClear Docs</a></h1>
                <p>Camera Server Documentation</p>
            </div>
            <nav class="sidebar-nav">
                <ul class="nav-menu">
                    <li class="nav-item depth-0">
<a href="/index.html">Home</a>
</li>
<li class="nav-item depth-0">
<a href="/getting-started.html">Getting Started</a>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Architecture</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/architecture/overview.html">Overview</a>
</li>
<li class="nav-item depth-1">
<a href="/architecture/state-management.html">State Management</a>
</li>
<li class="nav-item depth-1">
<a href="/architecture/camera-pipeline.html">Camera Pipeline</a>
</li>
<li class="nav-item depth-1">
<a href="/architecture/metadata-sqlite.html">Metadata & SQLite</a>
</li>
<li class="nav-folder depth-1">
<span class="folder-title">Decisions</span>
<ul class="nav-submenu">
<li class="nav-item depth-2">
<a href="/architecture/decisions/ADR-0001-nim-language.html">ADR-0001 Nim Language</a>
</li>
<li class="nav-item depth-2">
<a href="/architecture/decisions/ADR-0002-corun-framework.html">ADR-0002 Corun Framework</a>
</li>
<li class="nav-item depth-2">
<a href="/architecture/decisions/ADR-0003-observable-state.html">ADR-0003 Observable State</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">API Reference</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/api/README.html">Overview</a>
</li>
<li class="nav-item depth-1">
<a href="/api/websocket-api.html">WebSocket API</a>
</li>
<li class="nav-item depth-1">
<a href="/api/http-api.html">HTTP API</a>
</li>
<li class="nav-item depth-1">
<a href="/api/rtsp-streaming.html">RTSP Streaming</a>
</li>
<li class="nav-folder depth-1">
<span class="folder-title">Examples</span>
<ul class="nav-submenu">
<li class="nav-item depth-2">
<a href="/api/examples/python-client.html">Python Client</a>
</li>
<li class="nav-item depth-2">
<a href="/api/examples/javascript-client.html">JavaScript Client</a>
</li>
<li class="nav-item depth-2">
<a href="/api/examples/csharp-client.html">C# Client</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Configuration</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/configuration/environments.html">Environments</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/factory-config.html">Factory Config</a>
</li>
<li class="nav-item depth-1 active">
<a href="/configuration/license-config.html">License Config</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/deployment-variants.html">Deployment Variants</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/camera-system.html">Camera System</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/network.html">Network</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/storage-backup.html">Storage & Backup</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/authentication.html">Authentication</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Camera System</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/camera/hardware-interface.html">Hardware Interface</a>
</li>
<li class="nav-item depth-1">
<a href="/camera/streaming.html">Streaming</a>
</li>
<li class="nav-item depth-1">
<a href="/camera/recording.html">Recording</a>
</li>
<li class="nav-item depth-1">
<a href="/camera/image-processing.html">Image Processing</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Operations</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/operations/build-and-deploy.html">Build and Deploy</a>
</li>
<li class="nav-item depth-1">
<a href="/operations/build-deploy.html">Build & Deploy (Alt)</a>
</li>
<li class="nav-item depth-1">
<a href="/operations/monitoring.html">Monitoring</a>
</li>
<li class="nav-item depth-1">
<a href="/operations/performance.html">Performance</a>
</li>
<li class="nav-item depth-1">
<a href="/operations/troubleshooting.html">Troubleshooting</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Security</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/security/authentication.html">Authentication</a>
</li>
<li class="nav-item depth-1">
<a href="/security/permissions.html">Permissions</a>
</li>
<li class="nav-item depth-1">
<a href="/security/ssl-certificates.html">SSL Certificates</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Testing</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/testing/testing-strategy.html">Strategy</a>
</li>
<li class="nav-item depth-1">
<a href="/testing/strategies.html">Strategies</a>
</li>
<li class="nav-item depth-1">
<a href="/testing/test-cases.html">Test Cases</a>
</li>
<li class="nav-item depth-1">
<a href="/testing/validation.html">Validation</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Integration</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/integration/onvif-protocol.html">ONVIF Protocol</a>
</li>
<li class="nav-item depth-1">
<a href="/integration/third-party.html">Third Party</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Reference</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/reference/glossary.html">Glossary</a>
</li>
<li class="nav-item depth-1">
<a href="/reference/requirements.html">Requirements</a>
</li>
<li class="nav-item depth-1">
<a href="/reference/state-observables.html">State Observables</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Releases</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/releases/CHANGELOG.html">Changelog</a>
</li>
</ul>
</li>
<li class="nav-item depth-0">
<a href="/glossary.html">Glossary</a>
</li>
                </ul>
            </nav>
        </aside>
        
        <main class="content">
            <div class="content-wrapper">
                <h1 id="license-configuration">License Configuration</h1>
<h2 id="overview">Overview</h2>
<p>The license configuration system controls feature availability, usage limits, and commercial terms for RotoClear camera deployments. It supports various licensing models from perpetual to subscription-based.</p>
<h2 id="license-types">License Types</h2>
<h3 id="commercial-license">Commercial License</h3>
<p>Full-featured license for commercial deployments:<br />
- Unlimited recording duration<br />
- All features enabled<br />
- Commercial support included<br />
- No watermarks or restrictions<br />
- Software updates included</p>
<h3 id="educational-license">Educational License</h3>
<p>Discounted license for educational institutions:<br />
- Extended recording retention<br />
- Multi-user support<br />
- Educational pricing<br />
- Limited to academic use<br />
- Community support</p>
<h3 id="demo-license">Demo License</h3>
<p>Time-limited evaluation license:<br />
- 30-day evaluation period<br />
- All features enabled<br />
- Watermark on output<br />
- Technical support during trial<br />
- Easy upgrade path</p>
<h3 id="development-license">Development License</h3>
<p>Development and testing only:<br />
- No production use<br />
- Extended logging enabled<br />
- Debug features accessible<br />
- Simulator mode available<br />
- No encryption requirements</p>
<h2 id="license-file-format">License File Format</h2>
<h3 id="structure">Structure</h3>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;licenseType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;commercial&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;issuedTo&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;organization&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Acme Medical Center&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;customerId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ACME-MED-001&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;contact&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin@acmemedical.com&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;validity&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;issuedDate&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-01T00:00:00Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;expirationDate&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-01-01T00:00:00Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;gracePerodDays&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;features&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;recording&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;maxDurationDays&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">365</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;formats&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;mp4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;avi&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;streaming&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;protocols&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;rtsp&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;webrtc&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;maxConcurrentClients&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;onvif&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.0&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;cloudIntegration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;provider&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;analytics&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;hardware&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;maxCameraHeads&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;maxResolution&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3840x2160&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;maxFps&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;users&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;maxUsers&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;roles&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;admin&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;operator&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;viewer&quot;</span><span class="p">]</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;storage&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;localEnabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;networkEnabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;cloudEnabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;maxStorageGB&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;support&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;premium&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;responseTimeSLA&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;4h&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;phone&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;+1-800-ROTOCLEAR&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;support@rotoclear.com&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;restrictions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;watermark&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;offlineMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;transferable&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;cryptography&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;encrypted&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;algorithm&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AES-256-GCM&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;signatureRequired&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="license-validation">License Validation</h2>
<h3 id="runtime-validation">Runtime Validation</h3>
<p>The system validates licenses at startup and periodically during operation:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">state</span><span class="o">/</span><span class="n">rc_licenses</span>

<span class="k">proc</span><span class="w"> </span><span class="nf">validateLicense</span><span class="o">*</span><span class="p">():</span><span class="w"> </span><span class="n">LicenseStatus</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">license</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loadLicense</span><span class="p">()</span>

<span class="w">  </span><span class="c"># Check expiration</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">license</span><span class="p">.</span><span class="n">validity</span><span class="p">.</span><span class="n">expirationDate</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">now</span><span class="p">():</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">license</span><span class="p">.</span><span class="n">validity</span><span class="p">.</span><span class="n">expirationDate</span><span class="p">).</span><span class="n">inDays</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">license</span><span class="p">.</span><span class="n">validity</span><span class="p">.</span><span class="n">gracePerodDays</span><span class="p">:</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">LicenseStatus</span><span class="p">.</span><span class="n">Expired</span>
<span class="w">    </span><span class="k">else</span><span class="p">:</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">LicenseStatus</span><span class="p">.</span><span class="n">GracePeriod</span>

<span class="w">  </span><span class="c"># Check signature</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">license</span><span class="p">.</span><span class="n">cryptography</span><span class="p">.</span><span class="n">signatureRequired</span><span class="p">:</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">verifySignature</span><span class="p">(</span><span class="n">license</span><span class="p">):</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">LicenseStatus</span><span class="p">.</span><span class="n">Invalid</span>

<span class="w">  </span><span class="c"># Check hardware binding</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">validateHardwareBinding</span><span class="p">(</span><span class="n">license</span><span class="p">):</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">LicenseStatus</span><span class="p">.</span><span class="n">HardwareMismatch</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">LicenseStatus</span><span class="p">.</span><span class="n">Valid</span>
</code></pre></div>

<h3 id="validation-checks">Validation Checks</h3>
<ol>
<li><strong>Signature verification</strong> - Cryptographic signature validation</li>
<li><strong>Expiration check</strong> - Compare current date with expiration</li>
<li><strong>Hardware binding</strong> - Verify system hardware matches license</li>
<li><strong>Feature flags</strong> - Validate requested features are licensed</li>
<li><strong>Usage limits</strong> - Check current usage against license limits</li>
</ol>
<h2 id="license-installation">License Installation</h2>
<h3 id="via-web-interface">Via Web Interface</h3>
<ol>
<li>Navigate to <strong>Settings &gt; License</strong></li>
<li>Click <strong>Upload License File</strong></li>
<li>Select <code>license_config.json</code> file</li>
<li>System validates and activates license</li>
<li>Restart required for full activation</li>
</ol>
<h3 id="via-command-line">Via Command Line</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Copy license file to system</span>
scp<span class="w"> </span>license_config.json<span class="w"> </span>root@rotoclear:/tmp/

<span class="c1"># Install license</span>
ssh<span class="w"> </span>root@rotoclear
<span class="nb">cd</span><span class="w"> </span>/config
cp<span class="w"> </span>/tmp/license_config.json<span class="w"> </span>.
systemctl<span class="w"> </span>restart<span class="w"> </span>rotordream
</code></pre></div>

<h3 id="encrypted-license-installation">Encrypted License Installation</h3>
<p>For production systems with encrypted licenses:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># License comes pre-encrypted</span>
<span class="c1"># Copy to decrypted_rsc directory</span>
cp<span class="w"> </span>encrypted_license.json<span class="w"> </span>/config/decrypted_rsc/license_config.json

<span class="c1"># System automatically decrypts on startup</span>
systemctl<span class="w"> </span>restart<span class="w"> </span>rotordream
</code></pre></div>

<h2 id="license-generation">License Generation</h2>
<h3 id="using-license-generator-tool">Using License Generator Tool</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Generate new license</span>
nim<span class="w"> </span>c<span class="w"> </span>-r<span class="w"> </span>licenser/licenser.nim<span class="w"> </span>generate<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--customer<span class="o">=</span><span class="s2">&quot;Acme Medical&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--type<span class="o">=</span>commercial<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--duration<span class="o">=</span><span class="m">365</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--features<span class="o">=</span>all<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--output<span class="o">=</span>license_config.json

<span class="c1"># Encrypt license for production</span>
nim<span class="w"> </span>c<span class="w"> </span>-r<span class="w"> </span>fcrypter/fcrypter.nim<span class="w"> </span>encrypt<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--input<span class="o">=</span>license_config.json<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--output<span class="o">=</span>encrypted_license.json<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--key-file<span class="o">=</span>master.key
</code></pre></div>

<h3 id="license-parameters">License Parameters</h3>
<ul>
<li><code>--customer</code> - Organization name</li>
<li><code>--type</code> - License type (commercial, educational, demo, dev)</li>
<li><code>--duration</code> - Validity period in days</li>
<li><code>--features</code> - Comma-separated feature list or "all"</li>
<li><code>--max-cameras</code> - Maximum camera heads</li>
<li><code>--max-users</code> - Maximum concurrent users</li>
<li><code>--hardware-id</code> - Bind to specific hardware (optional)</li>
</ul>
<h2 id="feature-enforcement">Feature Enforcement</h2>
<h3 id="runtime-feature-checks">Runtime Feature Checks</h3>
<div class="codehilite"><pre><span></span><code><span class="c"># Check if feature is licensed</span>
<span class="k">if</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;licenseRecordingEnabled&quot;</span><span class="p">).</span><span class="n">value</span><span class="p">.</span><span class="n">getBool</span><span class="p">:</span>
<span class="w">  </span><span class="n">startRecording</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
<span class="w">  </span><span class="n">showLicenseError</span><span class="p">(</span><span class="s">&quot;Recording not enabled in license&quot;</span><span class="p">)</span>

<span class="c"># Check usage limits</span>
<span class="k">let</span><span class="w"> </span><span class="n">currentUsers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getActiveUsers</span><span class="p">().</span><span class="n">len</span>
<span class="k">let</span><span class="w"> </span><span class="n">maxUsers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">State</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;licenseMaxUsers&quot;</span><span class="p">).</span><span class="n">value</span><span class="p">.</span><span class="n">getInt</span>
<span class="k">if</span><span class="w"> </span><span class="n">currentUsers</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">maxUsers</span><span class="p">:</span>
<span class="w">  </span><span class="n">rejectNewConnection</span><span class="p">(</span><span class="s">&quot;Maximum users reached&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="observable-integration">Observable Integration</h3>
<p>License features are exposed as observables:</p>
<ul>
<li><code>licenseType</code> - License type string</li>
<li><code>licenseValid</code> - Boolean validity status</li>
<li><code>licenseExpirationDate</code> - Expiration timestamp</li>
<li><code>licenseRecordingEnabled</code> - Recording feature flag</li>
<li><code>licenseStreamingEnabled</code> - Streaming feature flag</li>
<li><code>licenseMaxUsers</code> - Maximum user count</li>
<li><code>licenseMaxCameras</code> - Maximum camera heads</li>
</ul>
<h2 id="hardware-binding">Hardware Binding</h2>
<h3 id="binding-mechanism">Binding Mechanism</h3>
<p>Licenses can be bound to specific hardware to prevent unauthorized transfers:</p>
<div class="codehilite"><pre><span></span><code><span class="k">proc</span><span class="w"> </span><span class="nf">generateHardwareId</span><span class="o">*</span><span class="p">():</span><span class="w"> </span><span class="nb">string</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="c"># Combine multiple hardware identifiers</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">cpuSerial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getCpuSerialNumber</span><span class="p">()</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">macAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getMacAddress</span><span class="p">(</span><span class="s">&quot;eth0&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">boardSerial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getBoardSerialNumber</span><span class="p">()</span>

<span class="w">  </span><span class="c"># Create unique hash</span>
<span class="w">  </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sha256</span><span class="p">(</span><span class="n">cpuSerial</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">macAddress</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">boardSerial</span><span class="p">).</span><span class="n">toHex</span><span class="p">()</span>
</code></pre></div>

<h3 id="binding-strategies">Binding Strategies</h3>
<ol>
<li><strong>CPU Serial</strong> - Bind to processor serial number</li>
<li><strong>MAC Address</strong> - Bind to network interface</li>
<li><strong>Board Serial</strong> - Bind to hardware board serial</li>
<li><strong>Combined</strong> - Use combination for stronger binding</li>
</ol>
<h2 id="license-expiration-handling">License Expiration Handling</h2>
<h3 id="expiration-states">Expiration States</h3>
<ol>
<li><strong>Valid</strong> - License within validity period</li>
<li><strong>Grace Period</strong> - Expired but within grace period</li>
<li><strong>Expired</strong> - Past grace period, features disabled</li>
<li><strong>Revoked</strong> - License explicitly revoked</li>
</ol>
<h3 id="grace-period-behavior">Grace Period Behavior</h3>
<p>During grace period (default 30 days):<br />
- System continues operating with warnings<br />
- Warning notifications displayed in UI<br />
- Email notifications sent to administrator<br />
- Recording continues but watermark added<br />
- Streaming remains available</p>
<p>After grace period:<br />
- Recording disabled<br />
- Streaming limited to local network<br />
- ONVIF access restricted<br />
- Administrative functions only</p>
<h2 id="subscription-licensing">Subscription Licensing</h2>
<h3 id="subscription-model">Subscription Model</h3>
<p>For subscription-based licenses:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;licenseType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;subscription&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;subscription&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;tier&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;premium&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;billingCycle&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;monthly&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;autoRenew&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;paymentStatus&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;current&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;validity&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;currentPeriodEnd&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-02-01T00:00:00Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;renewalUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://portal.rotoclear.com/renew&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="online-validation">Online Validation</h3>
<p>Subscription licenses require periodic online validation:</p>
<div class="codehilite"><pre><span></span><code><span class="c"># Check license status with licensing server</span>
<span class="k">proc</span><span class="w"> </span><span class="nf">validateOnline</span><span class="o">*</span><span class="p">():</span><span class="w"> </span><span class="n">Future</span><span class="o">[</span><span class="n">LicenseStatus</span><span class="o">]</span><span class="w"> </span><span class="sx">{.async.}</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">await</span><span class="w"> </span><span class="n">httpClient</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;https://license.rotoclear.com/validate&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;X-Hardware-ID&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">getHardwareId</span><span class="p">()}</span>
<span class="w">  </span><span class="p">)</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">200</span><span class="p">:</span>
<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseJson</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">body</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">status</span><span class="o">[</span><span class="s">&quot;valid&quot;</span><span class="o">]</span><span class="p">.</span><span class="n">getBool</span>
</code></pre></div>

<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="license-not-recognized">License Not Recognized</h3>
<p><strong>Symptoms</strong>: System operates in demo mode despite license installation.</p>
<p><strong>Solutions</strong>:<br />
- Verify license file location (<code>/config/decrypted_rsc/license_config.json</code>)<br />
- Check file permissions (should be readable by rotordream process)<br />
- Review startup logs for license validation errors<br />
- Ensure license is properly encrypted/decrypted</p>
<h3 id="hardware-binding-mismatch">Hardware Binding Mismatch</h3>
<p><strong>Symptoms</strong>: License shows as invalid on target hardware.</p>
<p><strong>Solutions</strong>:<br />
- Verify hardware ID matches license: <code>cat /config/hardware_id</code><br />
- Contact support for license transfer<br />
- Request hardware-id update for license<br />
- Use non-hardware-bound license for development</p>
<h3 id="expired-license">Expired License</h3>
<p><strong>Symptoms</strong>: Features disabled, expiration warnings displayed.</p>
<p><strong>Solutions</strong>:<br />
- Check current date and time settings<br />
- Verify system clock is synchronized (NTP)<br />
- Contact support for license renewal<br />
- Upload new license file</p>
<h3 id="feature-not-available">Feature Not Available</h3>
<p><strong>Symptoms</strong>: Feature appears disabled despite license.</p>
<p><strong>Solutions</strong>:<br />
- Review license file features section<br />
- Check observable values: <code>curl http://localhost:8080/api/state</code><br />
- Verify factory configuration allows feature<br />
- Restart system after license change</p>
<h2 id="security-best-practices">Security Best Practices</h2>
<h3 id="license-storage">License Storage</h3>
<ul>
<li>Store licenses in secure directory with restricted permissions</li>
<li>Use encrypted licenses for production deployments</li>
<li>Never commit license files to version control</li>
<li>Rotate encryption keys periodically</li>
</ul>
<h3 id="license-distribution">License Distribution</h3>
<ul>
<li>Use secure channels for license delivery (encrypted email, HTTPS)</li>
<li>Validate license recipient before distribution</li>
<li>Track license installations and activations</li>
<li>Implement revocation mechanism for compromised licenses</li>
</ul>
<h3 id="audit-logging">Audit Logging</h3>
<p>Enable comprehensive license audit logging:</p>
<div class="codehilite"><pre><span></span><code><span class="c"># Log all license-related events</span>
<span class="k">proc</span><span class="w"> </span><span class="nf">auditLog</span><span class="p">(</span><span class="n">event</span><span class="p">:</span><span class="w"> </span><span class="nb">string</span><span class="p">,</span><span class="w"> </span><span class="n">details</span><span class="p">:</span><span class="w"> </span><span class="n">JsonNode</span><span class="p">)</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="n">StateLogger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;LICENSE_AUDIT&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">,</span><span class="w"> </span><span class="n">details</span><span class="p">)</span>

<span class="n">auditLog</span><span class="p">(</span><span class="s">&quot;license_installed&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="p">{</span>
<span class="w">  </span><span class="s">&quot;customer&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">license</span><span class="p">.</span><span class="n">issuedTo</span><span class="p">.</span><span class="n">organization</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;expiration&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">license</span><span class="p">.</span><span class="n">validity</span><span class="p">.</span><span class="n">expirationDate</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;features&quot;</span><span class="p">:</span><span class="w"> </span><span class="n">license</span><span class="p">.</span><span class="n">features</span>
<span class="p">})</span>
</code></pre></div>

<h2 id="related-documentation">Related Documentation</h2>
<ul>
<li><a href="factory-config.md">Factory Configuration</a></li>
<li><a href="../security/authentication.md">Authentication</a></li>
<li><a href="../security/permissions.md">Permissions</a></li>
<li><a href="../operations/build-and-deploy.md">Build and Deploy</a></li>
</ul>
            </div>
            <footer class="content-footer">
                <p>Copyright © 2025 Rotoclear</p>
            </footer>
        </main>
        
        <button class="mobile-menu-toggle" id="menuToggle" aria-label="Toggle menu">☰</button>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        // Initialize Mermaid
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            fontFamily: 'Inter, sans-serif'
        });
        
        // Syntax highlighting
        hljs.highlightAll();
        
        // Mobile menu toggle
        const menuToggle = document.getElementById('menuToggle');
        const sidebar = document.querySelector('.sidebar');
        
        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
        });
        
        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', (e) => {
            if (window.innerWidth <= 768 && 
                !sidebar.contains(e.target) && 
                !menuToggle.contains(e.target) &&
                sidebar.classList.contains('active')) {
                sidebar.classList.remove('active');
            }
        });
        
        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });
    </script>
</body>
</html>