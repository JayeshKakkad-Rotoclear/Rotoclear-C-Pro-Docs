<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network - RotoClear Camera Server Documentation</title>
    <link rel="stylesheet" href="/assets/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><a href="/index.html">RotoClear Docs</a></h1>
                <p>Camera Server Documentation</p>
            </div>
            <nav class="sidebar-nav">
                <ul class="nav-menu">
                    <li class="nav-item depth-0">
<a href="/index.html">Home</a>
</li>
<li class="nav-item depth-0">
<a href="/getting-started.html">Getting Started</a>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Architecture</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/architecture/overview.html">Overview</a>
</li>
<li class="nav-item depth-1">
<a href="/architecture/state-management.html">State Management</a>
</li>
<li class="nav-item depth-1">
<a href="/architecture/camera-pipeline.html">Camera Pipeline</a>
</li>
<li class="nav-item depth-1">
<a href="/architecture/metadata-sqlite.html">Metadata & SQLite</a>
</li>
<li class="nav-folder depth-1">
<span class="folder-title">Decisions</span>
<ul class="nav-submenu">
<li class="nav-item depth-2">
<a href="/architecture/decisions/ADR-0001-nim-language.html">ADR-0001 Nim Language</a>
</li>
<li class="nav-item depth-2">
<a href="/architecture/decisions/ADR-0002-corun-framework.html">ADR-0002 Corun Framework</a>
</li>
<li class="nav-item depth-2">
<a href="/architecture/decisions/ADR-0003-observable-state.html">ADR-0003 Observable State</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">API Reference</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/api/README.html">Overview</a>
</li>
<li class="nav-item depth-1">
<a href="/api/websocket-api.html">WebSocket API</a>
</li>
<li class="nav-item depth-1">
<a href="/api/http-api.html">HTTP API</a>
</li>
<li class="nav-item depth-1">
<a href="/api/rtsp-streaming.html">RTSP Streaming</a>
</li>
<li class="nav-folder depth-1">
<span class="folder-title">Examples</span>
<ul class="nav-submenu">
<li class="nav-item depth-2">
<a href="/api/examples/python-client.html">Python Client</a>
</li>
<li class="nav-item depth-2">
<a href="/api/examples/javascript-client.html">JavaScript Client</a>
</li>
<li class="nav-item depth-2">
<a href="/api/examples/csharp-client.html">C# Client</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Configuration</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/configuration/environments.html">Environments</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/factory-config.html">Factory Config</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/license-config.html">License Config</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/deployment-variants.html">Deployment Variants</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/camera-system.html">Camera System</a>
</li>
<li class="nav-item depth-1 active">
<a href="/configuration/network.html">Network</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/storage-backup.html">Storage & Backup</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/authentication.html">Authentication</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Camera System</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/camera/hardware-interface.html">Hardware Interface</a>
</li>
<li class="nav-item depth-1">
<a href="/camera/streaming.html">Streaming</a>
</li>
<li class="nav-item depth-1">
<a href="/camera/recording.html">Recording</a>
</li>
<li class="nav-item depth-1">
<a href="/camera/image-processing.html">Image Processing</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Operations</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/operations/build-and-deploy.html">Build and Deploy</a>
</li>
<li class="nav-item depth-1">
<a href="/operations/build-deploy.html">Build & Deploy (Alt)</a>
</li>
<li class="nav-item depth-1">
<a href="/operations/monitoring.html">Monitoring</a>
</li>
<li class="nav-item depth-1">
<a href="/operations/performance.html">Performance</a>
</li>
<li class="nav-item depth-1">
<a href="/operations/troubleshooting.html">Troubleshooting</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Security</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/security/authentication.html">Authentication</a>
</li>
<li class="nav-item depth-1">
<a href="/security/permissions.html">Permissions</a>
</li>
<li class="nav-item depth-1">
<a href="/security/ssl-certificates.html">SSL Certificates</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Testing</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/testing/testing-strategy.html">Strategy</a>
</li>
<li class="nav-item depth-1">
<a href="/testing/strategies.html">Strategies</a>
</li>
<li class="nav-item depth-1">
<a href="/testing/test-cases.html">Test Cases</a>
</li>
<li class="nav-item depth-1">
<a href="/testing/validation.html">Validation</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Integration</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/integration/onvif-protocol.html">ONVIF Protocol</a>
</li>
<li class="nav-item depth-1">
<a href="/integration/third-party.html">Third Party</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Reference</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/reference/glossary.html">Glossary</a>
</li>
<li class="nav-item depth-1">
<a href="/reference/requirements.html">Requirements</a>
</li>
<li class="nav-item depth-1">
<a href="/reference/state-observables.html">State Observables</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Releases</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/releases/CHANGELOG.html">Changelog</a>
</li>
</ul>
</li>
<li class="nav-item depth-0">
<a href="/glossary.html">Glossary</a>
</li>
                </ul>
            </nav>
        </aside>
        
        <main class="content">
            <div class="content-wrapper">
                <h1 id="network-configuration">Network Configuration</h1>
<p><strong>Comprehensive network setup and management for camera devices.</strong></p>
<h2 id="overview">Overview</h2>
<p>The C Pro camera system provides flexible networking capabilities supporting wired Ethernet, wireless connectivity, and advanced network services for integration into various environments.</p>
<div class="mermaid">
graph TB
    A[Camera Device] --> B[Network Interface]
    B --> C{Connection Type}
    C -->|Ethernet| D[Wired Network]
    C -->|WiFi| E[Wireless Network]
    C -->|USB Tethering| F[Mobile Network]

    D --> G[DHCP/Static IP]
    E --> H[WiFi Access Point]
    F --> I[USB Host Device]

    G --> J[Network Services]
    H --> J
    I --> J

    J --> K[HTTP/HTTPS Server]
    J --> L[RTSP Streaming]
    J --> M[WebSocket API]
    J --> N[ONVIF Service]
    J --> O[mDNS/Bonjour]
</div>

<h2 id="network-interfaces">Network Interfaces</h2>
<h3 id="ethernet-configuration">Ethernet Configuration</h3>
<p><strong>Static IP Configuration</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># /etc/systemd/network/eth0.network</span>
<span class="o">[</span>Match<span class="o">]</span>
<span class="nv">Name</span><span class="o">=</span>eth0

<span class="o">[</span>Network<span class="o">]</span>
<span class="nv">Address</span><span class="o">=</span><span class="m">192</span>.168.1.100/24
<span class="nv">Gateway</span><span class="o">=</span><span class="m">192</span>.168.1.1
<span class="nv">DNS</span><span class="o">=</span><span class="m">8</span>.8.8.8
<span class="nv">DNS</span><span class="o">=</span><span class="m">8</span>.8.4.4
<span class="nv">DHCP</span><span class="o">=</span>no

<span class="o">[</span>Route<span class="o">]</span>
<span class="nv">Gateway</span><span class="o">=</span><span class="m">192</span>.168.1.1
<span class="nv">Destination</span><span class="o">=</span><span class="m">0</span>.0.0.0/0
</code></pre></div>

<p><strong>DHCP Configuration</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># /etc/systemd/network/eth0.network</span>
<span class="o">[</span>Match<span class="o">]</span>
<span class="nv">Name</span><span class="o">=</span>eth0

<span class="o">[</span>Network<span class="o">]</span>
<span class="nv">DHCP</span><span class="o">=</span>yes
<span class="nv">IPForward</span><span class="o">=</span>yes

<span class="o">[</span>DHCP<span class="o">]</span>
<span class="nv">UseDNS</span><span class="o">=</span>yes
<span class="nv">UseRoutes</span><span class="o">=</span>yes
<span class="nv">SendHostname</span><span class="o">=</span>yes
<span class="nv">Hostname</span><span class="o">=</span>rotorclear-cam
</code></pre></div>

<p><strong>Manual Configuration via API</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Set static IP</span>
curl<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span><span class="s2">&quot;http://192.168.1.100:8080/api/config/network&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer 1a2B3c4D5e6f7G8h&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">       &quot;ethernet&quot;: {</span>
<span class="s1">         &quot;enabled&quot;: true,</span>
<span class="s1">         &quot;mode&quot;: &quot;static&quot;,</span>
<span class="s1">         &quot;ip_address&quot;: &quot;192.168.1.100&quot;,</span>
<span class="s1">         &quot;subnet_mask&quot;: &quot;255.255.255.0&quot;,</span>
<span class="s1">         &quot;gateway&quot;: &quot;192.168.1.1&quot;,</span>
<span class="s1">         &quot;dns_servers&quot;: [&quot;8.8.8.8&quot;, &quot;8.8.4.4&quot;]</span>
<span class="s1">       }</span>
<span class="s1">     }&#39;</span>

<span class="c1"># Enable DHCP</span>
curl<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span><span class="s2">&quot;http://192.168.1.100:8080/api/config/network&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer 1a2B3c4D5e6f7G8h&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">       &quot;ethernet&quot;: {</span>
<span class="s1">         &quot;enabled&quot;: true,</span>
<span class="s1">         &quot;mode&quot;: &quot;dhcp&quot;,</span>
<span class="s1">         &quot;hostname&quot;: &quot;rotorclear-cam&quot;</span>
<span class="s1">       }</span>
<span class="s1">     }&#39;</span>
</code></pre></div>

<h3 id="wifi-configuration">WiFi Configuration</h3>
<p><strong>WiFi Client Mode</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Connect to existing WiFi network</span>
curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="s2">&quot;http://192.168.1.100:8080/api/wifi/connect&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer 1a2B3c4D5e6f7G8h&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">       &quot;ssid&quot;: &quot;Office-WiFi&quot;,</span>
<span class="s1">       &quot;password&quot;: &quot;wifi_password&quot;,</span>
<span class="s1">       &quot;security&quot;: &quot;WPA2-PSK&quot;,</span>
<span class="s1">       &quot;save_profile&quot;: true</span>
<span class="s1">     }&#39;</span>

<span class="c1"># List available networks</span>
curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer 1a2B3c4D5e6f7G8h&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span><span class="s2">&quot;http://192.168.1.100:8080/api/wifi/scan&quot;</span>
</code></pre></div>

<p><strong>WiFi Access Point Mode</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Create WiFi hotspot</span>
curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="s2">&quot;http://192.168.1.100:8080/api/wifi/hotspot&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer 1a2B3c4D5e6f7G8h&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">       &quot;ssid&quot;: &quot;RotorClear-CAM-001&quot;,</span>
<span class="s1">       &quot;password&quot;: &quot;rotorclear123&quot;,</span>
<span class="s1">       &quot;security&quot;: &quot;WPA2-PSK&quot;,</span>
<span class="s1">       &quot;channel&quot;: 6,</span>
<span class="s1">       &quot;ip_range&quot;: &quot;192.168.4.0/24&quot;</span>
<span class="s1">     }&#39;</span>
</code></pre></div>

<p><strong>wpa_supplicant Configuration</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># /etc/wpa_supplicant/wpa_supplicant.conf</span>
<span class="nv">ctrl_interface</span><span class="o">=</span><span class="nv">DIR</span><span class="o">=</span>/var/run/wpa_supplicant<span class="w"> </span><span class="nv">GROUP</span><span class="o">=</span>netdev
<span class="nv">update_config</span><span class="o">=</span><span class="m">1</span>
<span class="nv">country</span><span class="o">=</span>US

<span class="nv">network</span><span class="o">={</span>
<span class="w">    </span><span class="nv">ssid</span><span class="o">=</span><span class="s2">&quot;Office-WiFi&quot;</span>
<span class="w">    </span><span class="nv">psk</span><span class="o">=</span><span class="s2">&quot;wifi_password&quot;</span>
<span class="w">    </span><span class="nv">key_mgmt</span><span class="o">=</span>WPA-PSK
<span class="w">    </span><span class="nv">priority</span><span class="o">=</span><span class="m">10</span>
<span class="o">}</span>

<span class="nv">network</span><span class="o">={</span>
<span class="w">    </span><span class="nv">ssid</span><span class="o">=</span><span class="s2">&quot;Guest-Network&quot;</span>
<span class="w">    </span><span class="nv">key_mgmt</span><span class="o">=</span>NONE
<span class="w">    </span><span class="nv">priority</span><span class="o">=</span><span class="m">5</span>
<span class="o">}</span>

<span class="c1"># Enterprise WiFi (WPA2-Enterprise)</span>
<span class="nv">network</span><span class="o">={</span>
<span class="w">    </span><span class="nv">ssid</span><span class="o">=</span><span class="s2">&quot;Corporate-WiFi&quot;</span>
<span class="w">    </span><span class="nv">key_mgmt</span><span class="o">=</span>WPA-EAP
<span class="w">    </span><span class="nv">eap</span><span class="o">=</span>PEAP
<span class="w">    </span><span class="nv">identity</span><span class="o">=</span><span class="s2">&quot;username&quot;</span>
<span class="w">    </span><span class="nv">password</span><span class="o">=</span><span class="s2">&quot;password&quot;</span>
<span class="w">    </span><span class="nv">phase2</span><span class="o">=</span><span class="s2">&quot;auth=MSCHAPV2&quot;</span>
<span class="o">}</span>
</code></pre></div>

<h3 id="network-interface-management">Network Interface Management</h3>
<p><strong>Enable/Disable Interfaces</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Enable Ethernet</span>
sudo<span class="w"> </span>ip<span class="w"> </span>link<span class="w"> </span><span class="nb">set</span><span class="w"> </span>eth0<span class="w"> </span>up

<span class="c1"># Disable WiFi</span>
sudo<span class="w"> </span>ip<span class="w"> </span>link<span class="w"> </span><span class="nb">set</span><span class="w"> </span>wlan0<span class="w"> </span>down

<span class="c1"># Restart networking</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>systemd-networkd
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>wpa_supplicant
</code></pre></div>

<p><strong>Monitor Interface Status</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Check interface status</span>
ip<span class="w"> </span>addr<span class="w"> </span>show

<span class="c1"># Monitor network statistics</span>
watch<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>cat<span class="w"> </span>/proc/net/dev

<span class="c1"># Check wireless signal strength</span>
iwconfig<span class="w"> </span>wlan0
</code></pre></div>

<h2 id="service-configuration">Service Configuration</h2>
<h3 id="httphttps-server">HTTP/HTTPS Server</h3>
<p><strong>Basic HTTP Configuration</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># /etc/rotordream/server.conf</span>
<span class="k">[http]</span>
<span class="na">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">8080</span>
<span class="na">bind_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.0.0.0</span>
<span class="na">max_connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">100</span>
<span class="na">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">30</span>
<span class="na">cors_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">cors_origins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">*</span>

<span class="k">[https]</span>
<span class="na">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">8081</span>
<span class="na">ssl_cert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/etc/ssl/certs/rotordream.crt</span>
<span class="na">ssl_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/etc/ssl/private/rotordream.key</span>
<span class="na">ssl_protocols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">TLSv1.2,TLSv1.3</span>
<span class="na">ssl_ciphers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">ECDHE+AESGCM:ECDHE+CHACHA20:DHE+AESGCM:DHE+CHACHA20:!aNULL:!MD5:!DSS</span>
</code></pre></div>

<p><strong>SSL Certificate Generation</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Self-signed certificate for testing</span>
openssl<span class="w"> </span>req<span class="w"> </span>-x509<span class="w"> </span>-newkey<span class="w"> </span>rsa:4096<span class="w"> </span>-keyout<span class="w"> </span>/etc/ssl/private/rotordream.key<span class="w"> </span><span class="se">\</span>
<span class="w">            </span>-out<span class="w"> </span>/etc/ssl/certs/rotordream.crt<span class="w"> </span>-days<span class="w"> </span><span class="m">365</span><span class="w"> </span>-nodes<span class="w"> </span><span class="se">\</span>
<span class="w">            </span>-subj<span class="w"> </span><span class="s2">&quot;/C=US/ST=State/L=City/O=Organization/CN=rotorclear-cam&quot;</span>

<span class="c1"># Let&#39;s Encrypt certificate (if domain is available)</span>
certbot<span class="w"> </span>certonly<span class="w"> </span>--standalone<span class="w"> </span>--preferred-challenges<span class="w"> </span>http<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-d<span class="w"> </span>rotorclear-cam.example.com
</code></pre></div>

<h3 id="rtsp-streaming-server">RTSP Streaming Server</h3>
<p><strong>RTSP Configuration</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># /etc/rotordream/rtsp.conf</span>
<span class="k">[rtsp]</span>
<span class="na">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">554</span>
<span class="na">bind_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.0.0.0</span>
<span class="na">max_connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10</span>
<span class="na">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">60</span>
<span class="na">authentication_required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[streams]</span>
<span class="na">stream0_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/stream0</span>
<span class="na">stream0_resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1920x1080</span>
<span class="na">stream0_framerate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">30</span>
<span class="na">stream0_bitrate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">4000000</span>

<span class="na">stream1_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/stream1</span>
<span class="na">stream1_resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">640x480</span>
<span class="na">stream1_framerate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">15</span>
<span class="na">stream1_bitrate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1000000</span>
</code></pre></div>

<p><strong>RTSP URL Examples</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="cp"># Primary high-resolution stream</span>
<span class="nl">rtsp</span><span class="p">:</span><span class="c1">//192.168.1.100:554/stream0</span>

<span class="cp"># Secondary low-resolution stream</span>
<span class="nl">rtsp</span><span class="p">:</span><span class="c1">//192.168.1.100:554/stream1</span>

<span class="cp"># With authentication</span>
<span class="nl">rtsp</span><span class="p">:</span><span class="c1">//admin:password@192.168.1.100:554/stream0</span>
</code></pre></div>

<h3 id="mdnsbonjour-service-discovery">mDNS/Bonjour Service Discovery</h3>
<p><strong>Avahi Configuration</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="cm">&lt;!-- /etc/avahi/services/rotordream.service --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; standalone=&#39;no&#39;?&gt;</span>
<span class="cp">&lt;!DOCTYPE service-group SYSTEM &quot;avahi-service.dtd&quot;&gt;</span>
<span class="nt">&lt;service-group&gt;</span>
<span class="w">  </span><span class="nt">&lt;name</span><span class="w"> </span><span class="na">replace-wildcards=</span><span class="s">&quot;yes&quot;</span><span class="nt">&gt;</span>RotorClear<span class="w"> </span>Camera<span class="w"> </span>%h<span class="nt">&lt;/name&gt;</span>
<span class="w">  </span><span class="nt">&lt;service&gt;</span>
<span class="w">    </span><span class="nt">&lt;type&gt;</span>_http._tcp<span class="nt">&lt;/type&gt;</span>
<span class="w">    </span><span class="nt">&lt;port&gt;</span>8080<span class="nt">&lt;/port&gt;</span>
<span class="w">    </span><span class="nt">&lt;txt-record&gt;</span>path=/<span class="nt">&lt;/txt-record&gt;</span>
<span class="w">    </span><span class="nt">&lt;txt-record&gt;</span>version=1.0<span class="nt">&lt;/txt-record&gt;</span>
<span class="w">    </span><span class="nt">&lt;txt-record&gt;</span>model=RotorClear<span class="nt">&lt;/txt-record&gt;</span>
<span class="w">  </span><span class="nt">&lt;/service&gt;</span>
<span class="w">  </span><span class="nt">&lt;service&gt;</span>
<span class="w">    </span><span class="nt">&lt;type&gt;</span>_rtsp._tcp<span class="nt">&lt;/type&gt;</span>
<span class="w">    </span><span class="nt">&lt;port&gt;</span>554<span class="nt">&lt;/port&gt;</span>
<span class="w">    </span><span class="nt">&lt;txt-record&gt;</span>path=/stream0<span class="nt">&lt;/txt-record&gt;</span>
<span class="w">  </span><span class="nt">&lt;/service&gt;</span>
<span class="w">  </span><span class="nt">&lt;service&gt;</span>
<span class="w">    </span><span class="nt">&lt;type&gt;</span>_onvif._tcp<span class="nt">&lt;/type&gt;</span>
<span class="w">    </span><span class="nt">&lt;port&gt;</span>8080<span class="nt">&lt;/port&gt;</span>
<span class="w">    </span><span class="nt">&lt;txt-record&gt;</span>path=/onvif/device_service<span class="nt">&lt;/txt-record&gt;</span>
<span class="w">  </span><span class="nt">&lt;/service&gt;</span>
<span class="nt">&lt;/service-group&gt;</span>
</code></pre></div>

<p><strong>Service Discovery Client</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Discover C Pro cameras on network</span>
avahi-browse<span class="w"> </span>_http._tcp<span class="w"> </span>--resolve

<span class="c1"># Discover RTSP services</span>
avahi-browse<span class="w"> </span>_rtsp._tcp<span class="w"> </span>--resolve

<span class="c1"># Query specific service</span>
avahi-resolve<span class="w"> </span>-n<span class="w"> </span>rotorclear-cam.local
</code></pre></div>

<h2 id="firewall-configuration">Firewall Configuration</h2>
<h3 id="iptables-rules">iptables Rules</h3>
<p><strong>Basic Firewall Setup</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># /etc/rotordream/firewall.sh</span>

<span class="c1"># Flush existing rules</span>
iptables<span class="w"> </span>-F
iptables<span class="w"> </span>-X
iptables<span class="w"> </span>-t<span class="w"> </span>nat<span class="w"> </span>-F
iptables<span class="w"> </span>-t<span class="w"> </span>nat<span class="w"> </span>-X

<span class="c1"># Default policies</span>
iptables<span class="w"> </span>-P<span class="w"> </span>INPUT<span class="w"> </span>DROP
iptables<span class="w"> </span>-P<span class="w"> </span>FORWARD<span class="w"> </span>ACCEPT
iptables<span class="w"> </span>-P<span class="w"> </span>OUTPUT<span class="w"> </span>ACCEPT

<span class="c1"># Allow loopback</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-i<span class="w"> </span>lo<span class="w"> </span>-j<span class="w"> </span>ACCEPT

<span class="c1"># Allow established connections</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-m<span class="w"> </span>state<span class="w"> </span>--state<span class="w"> </span>ESTABLISHED,RELATED<span class="w"> </span>-j<span class="w"> </span>ACCEPT

<span class="c1"># Allow SSH (be careful!)</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">22</span><span class="w"> </span>-j<span class="w"> </span>ACCEPT

<span class="c1"># Allow HTTP/HTTPS</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">8080</span><span class="w"> </span>-j<span class="w"> </span>ACCEPT
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">8081</span><span class="w"> </span>-j<span class="w"> </span>ACCEPT

<span class="c1"># Allow RTSP</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">554</span><span class="w"> </span>-j<span class="w"> </span>ACCEPT

<span class="c1"># Allow RTP ports for RTSP streaming</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>udp<span class="w"> </span>--dport<span class="w"> </span><span class="m">5004</span>:5010<span class="w"> </span>-j<span class="w"> </span>ACCEPT

<span class="c1"># Allow mDNS</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>udp<span class="w"> </span>--dport<span class="w"> </span><span class="m">5353</span><span class="w"> </span>-j<span class="w"> </span>ACCEPT

<span class="c1"># Allow ONVIF WS-Discovery</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>udp<span class="w"> </span>--dport<span class="w"> </span><span class="m">3702</span><span class="w"> </span>-j<span class="w"> </span>ACCEPT

<span class="c1"># Allow ICMP (ping)</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>icmp<span class="w"> </span>-j<span class="w"> </span>ACCEPT

<span class="c1"># Log dropped packets</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-j<span class="w"> </span>LOG<span class="w"> </span>--log-prefix<span class="w"> </span><span class="s2">&quot;iptables-dropped: &quot;</span>

<span class="c1"># Save rules</span>
iptables-save<span class="w"> </span>&gt;<span class="w"> </span>/etc/iptables/rules.v4
</code></pre></div>

<p><strong>Advanced Rules with Rate Limiting</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Rate limit HTTP requests</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">8080</span><span class="w"> </span>-m<span class="w"> </span>state<span class="w"> </span>--state<span class="w"> </span>NEW<span class="w"> </span><span class="se">\</span>
<span class="w">         </span>-m<span class="w"> </span>recent<span class="w"> </span>--set<span class="w"> </span>--name<span class="w"> </span>http_limit
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">8080</span><span class="w"> </span>-m<span class="w"> </span>state<span class="w"> </span>--state<span class="w"> </span>NEW<span class="w"> </span><span class="se">\</span>
<span class="w">         </span>-m<span class="w"> </span>recent<span class="w"> </span>--update<span class="w"> </span>--seconds<span class="w"> </span><span class="m">60</span><span class="w"> </span>--hitcount<span class="w"> </span><span class="m">20</span><span class="w"> </span>--name<span class="w"> </span>http_limit<span class="w"> </span><span class="se">\</span>
<span class="w">         </span>-j<span class="w"> </span>LOG<span class="w"> </span>--log-prefix<span class="w"> </span><span class="s2">&quot;HTTP-RATE-LIMIT: &quot;</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">8080</span><span class="w"> </span>-m<span class="w"> </span>state<span class="w"> </span>--state<span class="w"> </span>NEW<span class="w"> </span><span class="se">\</span>
<span class="w">         </span>-m<span class="w"> </span>recent<span class="w"> </span>--update<span class="w"> </span>--seconds<span class="w"> </span><span class="m">60</span><span class="w"> </span>--hitcount<span class="w"> </span><span class="m">20</span><span class="w"> </span>--name<span class="w"> </span>http_limit<span class="w"> </span><span class="se">\</span>
<span class="w">         </span>-j<span class="w"> </span>DROP

<span class="c1"># Block specific IPs</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-s<span class="w"> </span><span class="m">192</span>.168.1.50<span class="w"> </span>-j<span class="w"> </span>DROP

<span class="c1"># Allow only specific subnet for admin access</span>
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">22</span><span class="w"> </span>-s<span class="w"> </span><span class="m">192</span>.168.1.0/24<span class="w"> </span>-j<span class="w"> </span>ACCEPT
iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">22</span><span class="w"> </span>-j<span class="w"> </span>DROP
</code></pre></div>

<h3 id="ufw-uncomplicated-firewall">UFW (Uncomplicated Firewall)</h3>
<p><strong>Basic UFW Configuration</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Enable UFW</span>
sudo<span class="w"> </span>ufw<span class="w"> </span><span class="nb">enable</span>

<span class="c1"># Default policies</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>default<span class="w"> </span>deny<span class="w"> </span>incoming
sudo<span class="w"> </span>ufw<span class="w"> </span>default<span class="w"> </span>allow<span class="w"> </span>outgoing

<span class="c1"># Allow SSH (be careful!)</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">22</span>/tcp

<span class="c1"># Allow HTTP services</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">8080</span>/tcp<span class="w"> </span>comment<span class="w"> </span><span class="s1">&#39;HTTP API&#39;</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">8081</span>/tcp<span class="w"> </span>comment<span class="w"> </span><span class="s1">&#39;HTTPS API&#39;</span>

<span class="c1"># Allow RTSP</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">554</span>/tcp<span class="w"> </span>comment<span class="w"> </span><span class="s1">&#39;RTSP streaming&#39;</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">5004</span>:5010/udp<span class="w"> </span>comment<span class="w"> </span><span class="s1">&#39;RTP data&#39;</span>

<span class="c1"># Allow mDNS</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">5353</span>/udp<span class="w"> </span>comment<span class="w"> </span><span class="s1">&#39;mDNS service discovery&#39;</span>

<span class="c1"># Allow from specific subnet only</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span>from<span class="w"> </span><span class="m">192</span>.168.1.0/24<span class="w"> </span>to<span class="w"> </span>any<span class="w"> </span>port<span class="w"> </span><span class="m">22</span>

<span class="c1"># Check status</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>status<span class="w"> </span>verbose
</code></pre></div>

<h2 id="quality-of-service-qos">Quality of Service (QoS)</h2>
<h3 id="traffic-shaping">Traffic Shaping</h3>
<p><strong>tc (Traffic Control) Configuration</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># /etc/rotordream/qos.sh</span>

<span class="nv">DEV</span><span class="o">=</span>eth0
<span class="nv">UPLOAD_RATE</span><span class="o">=</span>100mbit
<span class="nv">DOWNLOAD_RATE</span><span class="o">=</span>100mbit

<span class="c1"># Clear existing rules</span>
tc<span class="w"> </span>qdisc<span class="w"> </span>del<span class="w"> </span>dev<span class="w"> </span><span class="nv">$DEV</span><span class="w"> </span>root<span class="w"> </span><span class="m">2</span>&gt;/dev/null

<span class="c1"># Create root qdisc</span>
tc<span class="w"> </span>qdisc<span class="w"> </span>add<span class="w"> </span>dev<span class="w"> </span><span class="nv">$DEV</span><span class="w"> </span>root<span class="w"> </span>handle<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>htb<span class="w"> </span>default<span class="w"> </span><span class="m">30</span>

<span class="c1"># Create classes</span>
tc<span class="w"> </span>class<span class="w"> </span>add<span class="w"> </span>dev<span class="w"> </span><span class="nv">$DEV</span><span class="w"> </span>parent<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>classid<span class="w"> </span><span class="m">1</span>:1<span class="w"> </span>htb<span class="w"> </span>rate<span class="w"> </span><span class="nv">$UPLOAD_RATE</span>

<span class="c1"># High priority: RTSP/RTP traffic</span>
tc<span class="w"> </span>class<span class="w"> </span>add<span class="w"> </span>dev<span class="w"> </span><span class="nv">$DEV</span><span class="w"> </span>parent<span class="w"> </span><span class="m">1</span>:1<span class="w"> </span>classid<span class="w"> </span><span class="m">1</span>:10<span class="w"> </span>htb<span class="w"> </span>rate<span class="w"> </span>50mbit<span class="w"> </span>ceil<span class="w"> </span>80mbit<span class="w"> </span>prio<span class="w"> </span><span class="m">1</span>
tc<span class="w"> </span>class<span class="w"> </span>add<span class="w"> </span>dev<span class="w"> </span><span class="nv">$DEV</span><span class="w"> </span>parent<span class="w"> </span><span class="m">1</span>:1<span class="w"> </span>classid<span class="w"> </span><span class="m">1</span>:20<span class="w"> </span>htb<span class="w"> </span>rate<span class="w"> </span>30mbit<span class="w"> </span>ceil<span class="w"> </span>50mbit<span class="w"> </span>prio<span class="w"> </span><span class="m">2</span>
tc<span class="w"> </span>class<span class="w"> </span>add<span class="w"> </span>dev<span class="w"> </span><span class="nv">$DEV</span><span class="w"> </span>parent<span class="w"> </span><span class="m">1</span>:1<span class="w"> </span>classid<span class="w"> </span><span class="m">1</span>:30<span class="w"> </span>htb<span class="w"> </span>rate<span class="w"> </span>20mbit<span class="w"> </span>ceil<span class="w"> </span>30mbit<span class="w"> </span>prio<span class="w"> </span><span class="m">3</span>

<span class="c1"># Filters for RTSP traffic</span>
tc<span class="w"> </span>filter<span class="w"> </span>add<span class="w"> </span>dev<span class="w"> </span><span class="nv">$DEV</span><span class="w"> </span>protocol<span class="w"> </span>ip<span class="w"> </span>parent<span class="w"> </span><span class="m">1</span>:0<span class="w"> </span>prio<span class="w"> </span><span class="m">1</span><span class="w"> </span>u32<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>match<span class="w"> </span>ip<span class="w"> </span>dport<span class="w"> </span><span class="m">554</span><span class="w"> </span>0xffff<span class="w"> </span>flowid<span class="w"> </span><span class="m">1</span>:10
tc<span class="w"> </span>filter<span class="w"> </span>add<span class="w"> </span>dev<span class="w"> </span><span class="nv">$DEV</span><span class="w"> </span>protocol<span class="w"> </span>ip<span class="w"> </span>parent<span class="w"> </span><span class="m">1</span>:0<span class="w"> </span>prio<span class="w"> </span><span class="m">1</span><span class="w"> </span>u32<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>match<span class="w"> </span>ip<span class="w"> </span>dport<span class="w"> </span><span class="m">5004</span><span class="w"> </span>0xfffc<span class="w"> </span>flowid<span class="w"> </span><span class="m">1</span>:10

<span class="c1"># Filters for HTTP API</span>
tc<span class="w"> </span>filter<span class="w"> </span>add<span class="w"> </span>dev<span class="w"> </span><span class="nv">$DEV</span><span class="w"> </span>protocol<span class="w"> </span>ip<span class="w"> </span>parent<span class="w"> </span><span class="m">1</span>:0<span class="w"> </span>prio<span class="w"> </span><span class="m">2</span><span class="w"> </span>u32<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>match<span class="w"> </span>ip<span class="w"> </span>dport<span class="w"> </span><span class="m">8080</span><span class="w"> </span>0xffff<span class="w"> </span>flowid<span class="w"> </span><span class="m">1</span>:20
tc<span class="w"> </span>filter<span class="w"> </span>add<span class="w"> </span>dev<span class="w"> </span><span class="nv">$DEV</span><span class="w"> </span>protocol<span class="w"> </span>ip<span class="w"> </span>parent<span class="w"> </span><span class="m">1</span>:0<span class="w"> </span>prio<span class="w"> </span><span class="m">2</span><span class="w"> </span>u32<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>match<span class="w"> </span>ip<span class="w"> </span>dport<span class="w"> </span><span class="m">8081</span><span class="w"> </span>0xffff<span class="w"> </span>flowid<span class="w"> </span><span class="m">1</span>:20

<span class="c1"># DSCP marking for video traffic</span>
iptables<span class="w"> </span>-t<span class="w"> </span>mangle<span class="w"> </span>-A<span class="w"> </span>OUTPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">554</span><span class="w"> </span>-j<span class="w"> </span>DSCP<span class="w"> </span>--set-dscp<span class="w"> </span><span class="m">46</span>
iptables<span class="w"> </span>-t<span class="w"> </span>mangle<span class="w"> </span>-A<span class="w"> </span>OUTPUT<span class="w"> </span>-p<span class="w"> </span>udp<span class="w"> </span>--dport<span class="w"> </span><span class="m">5004</span>:5010<span class="w"> </span>-j<span class="w"> </span>DSCP<span class="w"> </span>--set-dscp<span class="w"> </span><span class="m">46</span>
</code></pre></div>

<h3 id="bandwidth-monitoring">Bandwidth Monitoring</h3>
<p><strong>Monitor Network Usage</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Real-time bandwidth monitoring</span>
iftop<span class="w"> </span>-i<span class="w"> </span>eth0

<span class="c1"># Network statistics</span>
nload<span class="w"> </span>eth0

<span class="c1"># Detailed interface statistics</span>
cat<span class="w"> </span>/proc/net/dev

<span class="c1"># Monitor specific ports</span>
netstat<span class="w"> </span>-tuln<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s1">&#39;:(554|8080|8081)&#39;</span>

<span class="c1"># Monitor connections</span>
ss<span class="w"> </span>-tuln<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s1">&#39;:(554|8080|8081)&#39;</span>
</code></pre></div>

<h2 id="vpn-configuration">VPN Configuration</h2>
<h3 id="openvpn-server">OpenVPN Server</h3>
<p><strong>Server Configuration</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># /etc/openvpn/server/camera-access.conf</span>
port<span class="w"> </span><span class="m">1194</span>
proto<span class="w"> </span>udp
dev<span class="w"> </span>tun

ca<span class="w"> </span>/etc/openvpn/server/ca.crt
cert<span class="w"> </span>/etc/openvpn/server/camera-server.crt
key<span class="w"> </span>/etc/openvpn/server/camera-server.key
dh<span class="w"> </span>/etc/openvpn/server/dh.pem

server<span class="w"> </span><span class="m">10</span>.8.0.0<span class="w"> </span><span class="m">255</span>.255.255.0
ifconfig-pool-persist<span class="w"> </span>/var/log/openvpn/ipp.txt

<span class="c1"># Routes to camera networks</span>
push<span class="w"> </span><span class="s2">&quot;route 192.168.1.0 255.255.255.0&quot;</span>
push<span class="w"> </span><span class="s2">&quot;redirect-gateway def1 bypass-dhcp&quot;</span>
push<span class="w"> </span><span class="s2">&quot;dhcp-option DNS 8.8.8.8&quot;</span>

keepalive<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">120</span>
tls-auth<span class="w"> </span>/etc/openvpn/server/ta.key<span class="w"> </span><span class="m">0</span>
cipher<span class="w"> </span>AES-256-CBC
auth<span class="w"> </span>SHA256

user<span class="w"> </span>nobody
group<span class="w"> </span>nogroup
persist-key
persist-tun

status<span class="w"> </span>/var/log/openvpn/openvpn-status.log
log-append<span class="w"> </span>/var/log/openvpn/openvpn.log
verb<span class="w"> </span><span class="m">3</span>
</code></pre></div>

<h3 id="wireguard-configuration">WireGuard Configuration</h3>
<p><strong>WireGuard Server</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># /etc/wireguard/wg0.conf</span>
<span class="k">[Interface]</span>
<span class="na">PrivateKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;server-private-key&gt;</span>
<span class="na">Address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10.0.0.1/24</span>
<span class="na">ListenPort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">51820</span>
<span class="na">PostUp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">iptables -A FORWARD -i %i -j ACCEPT</span><span class="c1">; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</span>
<span class="na">PostDown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">iptables -D FORWARD -i %i -j ACCEPT</span><span class="c1">; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE</span>

<span class="c1"># Client configurations</span>
<span class="k">[Peer]</span>
<span class="na">PublicKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;client-public-key&gt;</span>
<span class="na">AllowedIPs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10.0.0.2/32</span>

<span class="k">[Peer]</span>
<span class="na">PublicKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;client2-public-key&gt;</span>
<span class="na">AllowedIPs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10.0.0.3/32</span>
</code></pre></div>

<h2 id="network-diagnostics">Network Diagnostics</h2>
<h3 id="connection-testing">Connection Testing</h3>
<p><strong>Basic Connectivity Tests</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Test network connectivity</span>
ping<span class="w"> </span>-c<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">8</span>.8.8.8

<span class="c1"># Test DNS resolution</span>
nslookup<span class="w"> </span>google.com

<span class="c1"># Test HTTP connectivity</span>
curl<span class="w"> </span>-I<span class="w"> </span>http://192.168.1.100:8080/health

<span class="c1"># Test RTSP connectivity</span>
curl<span class="w"> </span>-v<span class="w"> </span>rtsp://192.168.1.100:554/stream0

<span class="c1"># Test port accessibility</span>
nc<span class="w"> </span>-zv<span class="w"> </span><span class="m">192</span>.168.1.100<span class="w"> </span><span class="m">8080</span>
nc<span class="w"> </span>-zv<span class="w"> </span><span class="m">192</span>.168.1.100<span class="w"> </span><span class="m">554</span>
</code></pre></div>

<p><strong>Network Performance Testing</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Bandwidth testing with iperf3</span>
<span class="c1"># On camera device (server)</span>
iperf3<span class="w"> </span>-s

<span class="c1"># On client</span>
iperf3<span class="w"> </span>-c<span class="w"> </span><span class="m">192</span>.168.1.100<span class="w"> </span>-t<span class="w"> </span><span class="m">30</span><span class="w"> </span>-i<span class="w"> </span><span class="m">1</span>

<span class="c1"># UDP performance test</span>
iperf3<span class="w"> </span>-c<span class="w"> </span><span class="m">192</span>.168.1.100<span class="w"> </span>-u<span class="w"> </span>-b<span class="w"> </span>10M<span class="w"> </span>-t<span class="w"> </span><span class="m">30</span>

<span class="c1"># Bidirectional test</span>
iperf3<span class="w"> </span>-c<span class="w"> </span><span class="m">192</span>.168.1.100<span class="w"> </span>--bidir<span class="w"> </span>-t<span class="w"> </span><span class="m">30</span>
</code></pre></div>

<h3 id="network-troubleshooting">Network Troubleshooting</h3>
<p><strong>Common Issues and Solutions</strong>:</p>
<p><strong>Connection Refused</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Check if service is running</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>status<span class="w"> </span>rotordream

<span class="c1"># Check if port is open</span>
sudo<span class="w"> </span>netstat<span class="w"> </span>-tlnp<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">8080</span>

<span class="c1"># Check firewall rules</span>
sudo<span class="w"> </span>iptables<span class="w"> </span>-L<span class="w"> </span>-n<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">8080</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>status
</code></pre></div>

<p><strong>Slow Performance</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Check network interface errors</span>
cat<span class="w"> </span>/proc/net/dev<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s1">&#39;(eth0|wlan0)&#39;</span>

<span class="c1"># Monitor real-time traffic</span>
tcpdump<span class="w"> </span>-i<span class="w"> </span>eth0<span class="w"> </span>-n<span class="w"> </span>host<span class="w"> </span><span class="m">192</span>.168.1.100

<span class="c1"># Check for packet loss</span>
ping<span class="w"> </span>-c<span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">192</span>.168.1.100<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span>
</code></pre></div>

<p><strong>WiFi Connection Issues</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Scan for networks</span>
sudo<span class="w"> </span>iwlist<span class="w"> </span>wlan0<span class="w"> </span>scan<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>ESSID

<span class="c1"># Check signal strength</span>
iwconfig<span class="w"> </span>wlan0

<span class="c1"># Restart WiFi service</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>wpa_supplicant

<span class="c1"># Check WiFi logs</span>
journalctl<span class="w"> </span>-u<span class="w"> </span>wpa_supplicant<span class="w"> </span>-f
</code></pre></div>

<h3 id="network-monitoring-scripts">Network Monitoring Scripts</h3>
<p><strong>Automated Network Health Check</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># /usr/local/bin/network-health-check.sh</span>

<span class="nv">LOG_FILE</span><span class="o">=</span><span class="s2">&quot;/var/log/rotordream/network-health.log&quot;</span>
<span class="nv">DATE</span><span class="o">=</span><span class="k">$(</span>date<span class="w"> </span><span class="s1">&#39;+%Y-%m-%d %H:%M:%S&#39;</span><span class="k">)</span>

<span class="c1"># Function to log messages</span>
log_message<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="nv">$DATE</span><span class="s2">] </span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="nv">$LOG_FILE</span>
<span class="o">}</span>

<span class="c1"># Check network interfaces</span>
check_interfaces<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>iface<span class="w"> </span><span class="k">in</span><span class="w"> </span>eth0<span class="w"> </span>wlan0<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span>ip<span class="w"> </span>link<span class="w"> </span>show<span class="w"> </span><span class="nv">$iface</span><span class="w"> </span>up<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span>log_message<span class="w"> </span><span class="s2">&quot;Interface </span><span class="nv">$iface</span><span class="s2"> is UP&quot;</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span>log_message<span class="w"> </span><span class="s2">&quot;ERROR: Interface </span><span class="nv">$iface</span><span class="s2"> is DOWN&quot;</span>
<span class="w">        </span><span class="k">fi</span>
<span class="w">    </span><span class="k">done</span>
<span class="o">}</span>

<span class="c1"># Check connectivity</span>
check_connectivity<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>ping<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">8</span>.8.8.8<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span>log_message<span class="w"> </span><span class="s2">&quot;Internet connectivity OK&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span>log_message<span class="w"> </span><span class="s2">&quot;ERROR: No internet connectivity&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>

<span class="c1"># Check services</span>
check_services<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>port<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">8080</span><span class="w"> </span><span class="m">554</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span>nc<span class="w"> </span>-z<span class="w"> </span>localhost<span class="w"> </span><span class="nv">$port</span><span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span>log_message<span class="w"> </span><span class="s2">&quot;Service on port </span><span class="nv">$port</span><span class="s2"> is running&quot;</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span>log_message<span class="w"> </span><span class="s2">&quot;ERROR: Service on port </span><span class="nv">$port</span><span class="s2"> is not running&quot;</span>
<span class="w">        </span><span class="k">fi</span>
<span class="w">    </span><span class="k">done</span>
<span class="o">}</span>

<span class="c1"># Run checks</span>
log_message<span class="w"> </span><span class="s2">&quot;Starting network health check&quot;</span>
check_interfaces
check_connectivity
check_services
log_message<span class="w"> </span><span class="s2">&quot;Network health check completed&quot;</span>
</code></pre></div>

<p><strong>Add to crontab for regular monitoring</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Run every 5 minutes</span>
*/5<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>/usr/local/bin/network-health-check.sh
</code></pre></div>

<h2 id="related-documentation">Related Documentation</h2>
<ul>
<li><a href="../security/authentication.md">Security Configuration</a> - Network security and access control</li>
<li><a href="../integration/onvif.md">ONVIF Integration</a> - ONVIF network service configuration</li>
<li><a href="../operations/performance.md">Performance Tuning</a> - Network performance optimization</li>
<li><a href="../operations/monitoring.md">Monitoring</a> - Network monitoring and alerting</li>
</ul>
<hr />
<p><em>Network configuration documentation based on systemd-networkd, iptables, and standard Linux networking tools</em></p>
            </div>
            <footer class="content-footer">
                <p>Copyright  2025 Rotoclear</p>
            </footer>
        </main>
        
        <button class="mobile-menu-toggle" id="menuToggle" aria-label="Toggle menu"></button>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        // Initialize Mermaid
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            fontFamily: 'Inter, sans-serif'
        });
        
        // Syntax highlighting
        hljs.highlightAll();
        
        // Mobile menu toggle
        const menuToggle = document.getElementById('menuToggle');
        const sidebar = document.querySelector('.sidebar');
        
        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
        });
        
        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', (e) => {
            if (window.innerWidth <= 768 && 
                !sidebar.contains(e.target) && 
                !menuToggle.contains(e.target) &&
                sidebar.classList.contains('active')) {
                sidebar.classList.remove('active');
            }
        });
        
        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });
    </script>
</body>
</html>