<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Factory Config - RotoClear Camera Server Documentation</title>
    <link rel="stylesheet" href="/assets/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><a href="/index.html">RotoClear Docs</a></h1>
                <p>Camera Server Documentation</p>
            </div>
            <nav class="sidebar-nav">
                <ul class="nav-menu">
                    <li class="nav-item depth-0">
<a href="/index.html">Home</a>
</li>
<li class="nav-item depth-0">
<a href="/getting-started.html">Getting Started</a>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Architecture</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/architecture/overview.html">Overview</a>
</li>
<li class="nav-item depth-1">
<a href="/architecture/state-management.html">State Management</a>
</li>
<li class="nav-item depth-1">
<a href="/architecture/camera-pipeline.html">Camera Pipeline</a>
</li>
<li class="nav-item depth-1">
<a href="/architecture/metadata-sqlite.html">Metadata & SQLite</a>
</li>
<li class="nav-folder depth-1">
<span class="folder-title">Decisions</span>
<ul class="nav-submenu">
<li class="nav-item depth-2">
<a href="/architecture/decisions/ADR-0001-nim-language.html">ADR-0001 Nim Language</a>
</li>
<li class="nav-item depth-2">
<a href="/architecture/decisions/ADR-0002-corun-framework.html">ADR-0002 Corun Framework</a>
</li>
<li class="nav-item depth-2">
<a href="/architecture/decisions/ADR-0003-observable-state.html">ADR-0003 Observable State</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">API Reference</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/api/README.html">Overview</a>
</li>
<li class="nav-item depth-1">
<a href="/api/websocket-api.html">WebSocket API</a>
</li>
<li class="nav-item depth-1">
<a href="/api/http-api.html">HTTP API</a>
</li>
<li class="nav-item depth-1">
<a href="/api/rtsp-streaming.html">RTSP Streaming</a>
</li>
<li class="nav-folder depth-1">
<span class="folder-title">Examples</span>
<ul class="nav-submenu">
<li class="nav-item depth-2">
<a href="/api/examples/python-client.html">Python Client</a>
</li>
<li class="nav-item depth-2">
<a href="/api/examples/javascript-client.html">JavaScript Client</a>
</li>
<li class="nav-item depth-2">
<a href="/api/examples/csharp-client.html">C# Client</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Configuration</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/configuration/environments.html">Environments</a>
</li>
<li class="nav-item depth-1 active">
<a href="/configuration/factory-config.html">Factory Config</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/license-config.html">License Config</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/deployment-variants.html">Deployment Variants</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/camera-system.html">Camera System</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/network.html">Network</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/storage-backup.html">Storage & Backup</a>
</li>
<li class="nav-item depth-1">
<a href="/configuration/authentication.html">Authentication</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Camera System</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/camera/hardware-interface.html">Hardware Interface</a>
</li>
<li class="nav-item depth-1">
<a href="/camera/streaming.html">Streaming</a>
</li>
<li class="nav-item depth-1">
<a href="/camera/recording.html">Recording</a>
</li>
<li class="nav-item depth-1">
<a href="/camera/image-processing.html">Image Processing</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Operations</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/operations/build-and-deploy.html">Build and Deploy</a>
</li>
<li class="nav-item depth-1">
<a href="/operations/build-deploy.html">Build & Deploy (Alt)</a>
</li>
<li class="nav-item depth-1">
<a href="/operations/monitoring.html">Monitoring</a>
</li>
<li class="nav-item depth-1">
<a href="/operations/performance.html">Performance</a>
</li>
<li class="nav-item depth-1">
<a href="/operations/troubleshooting.html">Troubleshooting</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Security</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/security/authentication.html">Authentication</a>
</li>
<li class="nav-item depth-1">
<a href="/security/permissions.html">Permissions</a>
</li>
<li class="nav-item depth-1">
<a href="/security/ssl-certificates.html">SSL Certificates</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Testing</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/testing/testing-strategy.html">Strategy</a>
</li>
<li class="nav-item depth-1">
<a href="/testing/strategies.html">Strategies</a>
</li>
<li class="nav-item depth-1">
<a href="/testing/test-cases.html">Test Cases</a>
</li>
<li class="nav-item depth-1">
<a href="/testing/validation.html">Validation</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Integration</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/integration/onvif-protocol.html">ONVIF Protocol</a>
</li>
<li class="nav-item depth-1">
<a href="/integration/third-party.html">Third Party</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Reference</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/reference/glossary.html">Glossary</a>
</li>
<li class="nav-item depth-1">
<a href="/reference/requirements.html">Requirements</a>
</li>
<li class="nav-item depth-1">
<a href="/reference/state-observables.html">State Observables</a>
</li>
</ul>
</li>
<li class="nav-folder depth-0">
<span class="folder-title">Releases</span>
<ul class="nav-submenu">
<li class="nav-item depth-1">
<a href="/releases/CHANGELOG.html">Changelog</a>
</li>
</ul>
</li>
<li class="nav-item depth-0">
<a href="/glossary.html">Glossary</a>
</li>
                </ul>
            </nav>
        </aside>
        
        <main class="content">
            <div class="content-wrapper">
                <h1 id="factory-configuration">Factory Configuration</h1>
<h2 id="overview">Overview</h2>
<p>The factory configuration system provides a flexible mechanism to customize RotoClear camera behavior for different deployment scenarios, customers, and use cases. Configuration files are embedded during the build process and control system behavior at runtime.</p>
<h2 id="configuration-structure">Configuration Structure</h2>
<h3 id="directory-layout">Directory Layout</h3>
<div class="codehilite"><pre><span></span><code><span class="n">rsc_config</span><span class="o">/</span>
<span class="err">├──</span><span class="w"> </span><span class="n">config_DEFAULT</span><span class="o">/</span><span class="w">     </span><span class="c1"># Default minimal configuration</span>
<span class="err">├──</span><span class="w"> </span><span class="n">config_DEMO</span><span class="o">/</span><span class="w">        </span><span class="c1"># Demo/trial version settings</span>
<span class="err">├──</span><span class="w"> </span><span class="n">config_DEV</span><span class="o">/</span><span class="w">         </span><span class="c1"># Development environment</span>
<span class="err">├──</span><span class="w"> </span><span class="n">config_EDU</span><span class="o">/</span><span class="w">         </span><span class="c1"># Educational institutions</span>
<span class="err">├──</span><span class="w"> </span><span class="n">config_rc_DMG</span><span class="o">/</span><span class="w">      </span><span class="c1"># RotoClear DMG variant</span>
<span class="err">└──</span><span class="w"> </span><span class="n">config_VB</span><span class="o">/</span><span class="w">          </span><span class="c1"># VB customer variant</span>
</code></pre></div>

<p>Each configuration directory can contain:</p>
<ul>
<li><code>factory_config.json</code> - System behavior and feature flags</li>
<li><code>license_config.json</code> - License and feature restrictions</li>
<li><code>style_variables_config.json</code> - UI customization</li>
<li><code>version_flavor</code> - Build variant identifier</li>
<li><code>imgs/</code> - Custom UI assets</li>
<li><code>hdmi_imgs/</code> - HDMI output specific assets</li>
<li><code>stylesheets/</code> - CSS overrides</li>
</ul>
<h2 id="factory-configuration-file">Factory Configuration File</h2>
<h3 id="structure">Structure</h3>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;systemName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RotoClear DMG&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;modelNumber&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RC-DMG-4K&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;features&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;recording&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;streaming&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;onvif&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;webrtc&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;pip&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;zoom&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;autoRotate&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;hardware&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;cameraHeads&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;maxResolution&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3840x2160&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;maxFps&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;hasLightControl&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;hasRotationMotor&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;hasFpgaTemp&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;network&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;defaultDhcp&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;allowStaticIp&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;allowWifi&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;defaultHostname&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;rotoclear&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;storage&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;localEnabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;networkEnabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;backupEnabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;minDiskSpaceGB&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;ui&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;showWizard&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;defaultLanguage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;en&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;availableLanguages&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;en&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;de&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;theme&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="key-sections">Key Sections</h3>
<h4 id="features">Features</h4>
<p>Controls which system features are enabled:<br />
- <code>recording</code> - Video recording capabilities<br />
- <code>streaming</code> - RTSP/WebRTC streaming<br />
- <code>onvif</code> - ONVIF protocol support<br />
- <code>webrtc</code> - WebRTC streaming<br />
- <code>pip</code> - Picture-in-picture mode<br />
- <code>zoom</code> - Digital zoom functionality<br />
- <code>autoRotate</code> - Automatic rotation detection</p>
<h4 id="hardware">Hardware</h4>
<p>Defines hardware-specific capabilities:<br />
- <code>cameraHeads</code> - Number of camera inputs<br />
- <code>maxResolution</code> - Maximum video resolution<br />
- <code>maxFps</code> - Maximum frames per second<br />
- <code>hasLightControl</code> - Integrated lighting control<br />
- <code>hasRotationMotor</code> - Motorized rotation platform<br />
- <code>hasFpgaTemp</code> - FPGA temperature monitoring</p>
<h4 id="network">Network</h4>
<p>Network configuration defaults:<br />
- <code>defaultDhcp</code> - Use DHCP by default<br />
- <code>allowStaticIp</code> - Allow manual IP configuration<br />
- <code>allowWifi</code> - Enable WiFi support<br />
- <code>defaultHostname</code> - Default network hostname</p>
<h2 id="license-configuration">License Configuration</h2>
<h3 id="structure_1">Structure</h3>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;licenseType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;commercial&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;expirationDate&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;maxCameras&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;features&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;recording&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;cloudUpload&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;advancedAnalytics&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;customer&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Acme Corporation&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ACME-001&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;support&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;premium&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;restrictions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;maxRecordingDays&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">365</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;maxUsers&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;watermark&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="license-types">License Types</h3>
<ul>
<li><strong>commercial</strong> - Full-featured commercial license</li>
<li><strong>educational</strong> - Educational institution license with restrictions</li>
<li><strong>demo</strong> - Time-limited demonstration license</li>
<li><strong>development</strong> - Development and testing only</li>
</ul>
<h2 id="style-variables-configuration">Style Variables Configuration</h2>
<p>Customize UI appearance without code changes:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;colors&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;primary&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#123345&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;secondary&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#FF6B35&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;accent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#FFA500&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;background&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#FFFFFF&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;text&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#333333&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;branding&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;logo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;custom-logo.svg&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;favicon&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;custom-favicon.ico&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;companyName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Custom Medical Equipment&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;layout&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;showCompanyLogo&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;compactMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;hideAdvancedSettings&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="build-integration">Build Integration</h2>
<h3 id="configuration-selection">Configuration Selection</h3>
<p>The build system selects configuration using the <code>CONFIG_VARIANT</code> environment variable:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Build with specific configuration</span>
<span class="nv">CONFIG_VARIANT</span><span class="o">=</span>rc_DMG<span class="w"> </span>nim<span class="w"> </span>c<span class="w"> </span>rotordream.nim

<span class="c1"># Or use build script</span>
nim<span class="w"> </span>c<span class="w"> </span>-r<span class="w"> </span>tools/buildRelease.nim<span class="w"> </span>--variant<span class="o">=</span>rc_DMG
</code></pre></div>

<h3 id="resource-embedding">Resource Embedding</h3>
<p>The <code>buildResourceConfigs.nim</code> tool embeds configuration files into the binary:</p>
<div class="codehilite"><pre><span></span><code><span class="c"># Embeds all files from selected config directory</span>
<span class="k">proc</span><span class="w"> </span><span class="nf">embedConfig</span><span class="o">*</span><span class="p">(</span><span class="n">variant</span><span class="p">:</span><span class="w"> </span><span class="nb">string</span><span class="p">)</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">configDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;rsc_config&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">&quot;config_&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">variant</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">walkDirRec</span><span class="p">(</span><span class="n">configDir</span><span class="p">):</span>
<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="n">resourceKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file</span><span class="p">.</span><span class="n">relativePath</span><span class="p">(</span><span class="n">configDir</span><span class="p">)</span>
<span class="w">    </span><span class="n">embedResource</span><span class="p">(</span><span class="n">resourceKey</span><span class="p">,</span><span class="w"> </span><span class="n">readFile</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
</code></pre></div>

<h2 id="runtime-access">Runtime Access</h2>
<h3 id="loading-configuration">Loading Configuration</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">state</span><span class="o">/</span><span class="n">factory_config</span>

<span class="c"># Access factory configuration</span>
<span class="k">let</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getFactoryConfig</span><span class="p">()</span>

<span class="k">if</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">features</span><span class="p">.</span><span class="n">recording</span><span class="p">:</span>
<span class="w">  </span><span class="n">initRecordingSystem</span><span class="p">()</span>

<span class="k">if</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">hardware</span><span class="p">.</span><span class="n">hasLightControl</span><span class="p">:</span>
<span class="w">  </span><span class="n">initLightControl</span><span class="p">()</span>
</code></pre></div>

<h3 id="configuration-precedence">Configuration Precedence</h3>
<ol>
<li><strong>Embedded factory config</strong> - Compiled into binary</li>
<li><strong>Decrypted runtime config</strong> - For licensed features</li>
<li><strong>User settings</strong> - Stored in LocalStorage</li>
<li><strong>Default values</strong> - Hardcoded fallbacks</li>
</ol>
<h2 id="configuration-variants">Configuration Variants</h2>
<h3 id="config_default">config_DEFAULT</h3>
<p>Minimal configuration for basic functionality. Used when no specific variant is selected.</p>
<h3 id="config_demo">config_DEMO</h3>
<ul>
<li>Time-limited operation (30 days)</li>
<li>Watermark on video output</li>
<li>Limited recording capacity</li>
<li>All features enabled for evaluation</li>
</ul>
<h3 id="config_dev">config_DEV</h3>
<ul>
<li>Extended logging enabled</li>
<li>Debug endpoints exposed</li>
<li>Relaxed security for development</li>
<li>Simulator mode available</li>
</ul>
<h3 id="config_edu">config_EDU</h3>
<ul>
<li>Educational institution branding</li>
<li>Extended recording retention</li>
<li>Multi-user collaboration features</li>
<li>Reduced cost tier</li>
</ul>
<h3 id="config_rc_dmg">config_rc_DMG</h3>
<ul>
<li>RotoClear DMG product line</li>
<li>Dual camera head support</li>
<li>Integrated rotation control</li>
<li>Medical-grade recording quality</li>
</ul>
<h3 id="config_vb">config_VB</h3>
<ul>
<li>Customer-specific customization</li>
<li>Custom branding and colors</li>
<li>Specialized workflow integration</li>
<li>Unique feature set</li>
</ul>
<h2 id="security-considerations">Security Considerations</h2>
<h3 id="encryption">Encryption</h3>
<ul>
<li><code>license_config.json</code> is encrypted in production builds</li>
<li>Decryption key stored in secure hardware element</li>
<li>Configuration integrity verified at startup</li>
</ul>
<h3 id="tampering-prevention">Tampering Prevention</h3>
<ul>
<li>Configuration embedded in binary</li>
<li>Runtime modification disabled in release builds</li>
<li>Signature verification for updates</li>
</ul>
<h2 id="best-practices">Best Practices</h2>
<h3 id="creating-new-variants">Creating New Variants</h3>
<ol>
<li>
<p><strong>Copy base configuration</strong><br />
<code>bash
   cp -r rsc_config/config_DEFAULT rsc_config/config_NEWVARIANT</code></p>
</li>
<li>
<p><strong>Customize configuration files</strong><br />
   - Update <code>factory_config.json</code> with specific settings<br />
   - Add custom assets to <code>imgs/</code> directory<br />
   - Modify <code>version_flavor</code> file</p>
</li>
<li>
<p><strong>Test thoroughly</strong><br />
<code>bash
   CONFIG_VARIANT=NEWVARIANT nim c rotordream.nim
   ./rotordream</code></p>
</li>
<li>
<p><strong>Document changes</strong><br />
   - Update this documentation<br />
   - Add variant to CI/CD pipeline<br />
   - Document customer-specific requirements</p>
</li>
</ol>
<h3 id="configuration-validation">Configuration Validation</h3>
<p>Always validate configuration files before building:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Validate JSON syntax</span>
nim<span class="w"> </span>c<span class="w"> </span>-r<span class="w"> </span>tools/validateConfig.nim<span class="w"> </span>rsc_config/config_rc_DMG/factory_config.json

<span class="c1"># Test configuration loading</span>
nim<span class="w"> </span>c<span class="w"> </span>-r<span class="w"> </span>tests/test_factory_config.nim
</code></pre></div>

<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="configuration-not-loaded">Configuration Not Loaded</h3>
<p><strong>Problem</strong>: System uses default settings instead of variant configuration.</p>
<p><strong>Solution</strong>:<br />
- Verify <code>CONFIG_VARIANT</code> environment variable is set<br />
- Check configuration directory exists<br />
- Ensure <code>buildResourceConfigs.nim</code> was executed</p>
<h3 id="license-validation-fails">License Validation Fails</h3>
<p><strong>Problem</strong>: License configuration rejected at startup.</p>
<p><strong>Solution</strong>:<br />
- Verify license file encryption/decryption keys<br />
- Check expiration date<br />
- Validate JSON structure</p>
<h3 id="custom-assets-not-displayed">Custom Assets Not Displayed</h3>
<p><strong>Problem</strong>: Custom logos or images don't appear in UI.</p>
<p><strong>Solution</strong>:<br />
- Verify files exist in <code>imgs/</code> directory<br />
- Check file paths in <code>style_variables_config.json</code><br />
- Ensure assets are embedded during build</p>
<h2 id="related-documentation">Related Documentation</h2>
<ul>
<li><a href="deployment-variants.md">Deployment Variants</a></li>
<li><a href="license-config.md">License Configuration</a></li>
<li><a href="../operations/build-and-deploy.md">Build and Deploy</a></li>
<li><a href="environments.md">Environments</a></li>
</ul>
            </div>
            <footer class="content-footer">
                <p>Copyright © 2025 Rotoclear</p>
            </footer>
        </main>
        
        <button class="mobile-menu-toggle" id="menuToggle" aria-label="Toggle menu">☰</button>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        // Initialize Mermaid
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            fontFamily: 'Inter, sans-serif'
        });
        
        // Syntax highlighting
        hljs.highlightAll();
        
        // Mobile menu toggle
        const menuToggle = document.getElementById('menuToggle');
        const sidebar = document.querySelector('.sidebar');
        
        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
        });
        
        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', (e) => {
            if (window.innerWidth <= 768 && 
                !sidebar.contains(e.target) && 
                !menuToggle.contains(e.target) &&
                sidebar.classList.contains('active')) {
                sidebar.classList.remove('active');
            }
        });
        
        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });
    </script>
</body>
</html>